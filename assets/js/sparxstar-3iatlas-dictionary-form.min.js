jQuery(document).ready(function(e){var n,t,a=e("#example-sentences-container .sentence-row").length,s=window.sparxstarDict||{};function i(n,t){if(!(e("#selected-synonyms").find('[data-id="'+n+'"]').length>0)){var a=e('<span class="synonym-tag" role="listitem">').attr("data-id",n).html(t+' <button type="button" class="remove-synonym" aria-label="Remove synonym '+t+'">Ã—</button>');e("#selected-synonyms").append(a),o(),e("#synonym-results").empty(),e("#aiwa_synonyms_search").val("")}}function o(){var n=[];e("#selected-synonyms .synonym-tag").each(function(){n.push(e(this).data("id"))}),e("#aiwa_synonyms").val(n.join(","))}e("#add-sentence-btn").on("click",function(){var n=a++,t='\n            <div class="sentence-row" data-index="'.concat(n,'">\n                <div class="sentence-fields">\n                    <div class="form-group">\n                        <label for="sentence_').concat(n,'_text">Sentence</label>\n                        <input type="text" id="sentence_').concat(n,'_text" name="sentences[').concat(n,'][aiwa_sentence]">\n                    </div>\n                    <div class="form-group">\n                        <label for="sentence_').concat(n,'_trans">Translation</label>\n                        <input type="text" id="sentence_').concat(n,'_trans" name="sentences[').concat(n,'][aiwa_s_translation]">\n                    </div>\n                    <div class="form-group">\n                        <label for="sentence_').concat(n,'_trans_en">Translation (English)</label>\n                        <input type="text" id="sentence_').concat(n,'_trans_en" name="sentences[').concat(n,'][aiwa_s_translation_english]">\n                    </div>\n                    <div class="form-group">\n                        <label for="sentence_').concat(n,'_trans_fr">Translation (French)</label>\n                        <input type="text" id="sentence_').concat(n,'_trans_fr" name="sentences[').concat(n,'][aiwa_s_translation_french]">\n                    </div>\n                </div>\n                <button type="button" class="btn-text remove-sentence-btn" aria-label="Remove sentence">Remove</button>\n            </div>\n        ');e("#example-sentences-container").append(t)}),e(document).on("click",".remove-sentence-btn",function(){e(this).closest(".sentence-row").remove()}),e(document).on("click",".upload-media-btn",function(t){t.preventDefault();var a=e(this),s=a.data("field"),i=a.data("type"),o=a.closest(".media-upload-container");n||(n=wp.media({title:"image"===i?"Choose Image":"Choose Audio File",button:{text:"Use this file"},library:{type:"image"===i?"image":"audio"},multiple:!1})).on("select",function(){var t=n.state().get("selection").first().toJSON();e("#"+s).val("image"===i?t.id:t.url),"image"===i?(o.find(".image-preview-container").html('<img src="'+t.url+'" alt="Preview">'),o.find(".remove-media-btn").attr("aria-label","Remove image")):(o.find(".media-filename").text(t.filename),o.find(".remove-media-btn").attr("aria-label","Remove audio file")),o.find(".remove-media-btn").show()}),n.open()}),e(document).on("click",".remove-media-btn",function(n){n.preventDefault();var t=e(this).closest(".media-upload-container");t.find('input[type="hidden"]').val(""),t.find(".media-filename").text(""),t.find(".image-preview-container").html(""),e(this).hide()}),e("#aiwa_synonyms_search").on("keyup",function(){clearTimeout(t);var n=e(this).val();n.length<2?e("#synonym-results").empty():t=setTimeout(function(){e.ajax({url:s.ajaxurl,type:"POST",data:{action:"aiwa_dict_search_synonyms",nonce:s.nonce,search:n},success:function(n){var t,a;n.success&&(t=n.data.results,(a=e("#synonym-results")).empty(),0!==t.length?t.forEach(function(n){var t=e('<div class="synonym-result-item" role="option">').text(n.title).data("id",n.id).on("click",function(){i(n.id,n.title)}).on("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),i(n.id,n.title))}).attr("tabindex","0");a.append(t)}):a.html('<div class="no-results">No results found</div>'))}})},300)}),e(document).on("click",".remove-synonym",function(n){n.preventDefault(),e(this).closest(".synonym-tag").remove(),o()}),e("#sparx-dict-form").on("submit",function(n){n.preventDefault();var t=e(this),a=e("#submit-btn"),i=e("#form-message");a.prop("disabled",!0).text("Saving..."),i.empty();var o=t.serialize(),c=t.data("entry-id");e.ajax({url:s.ajaxurl,type:"POST",data:o+"&action=aiwa_dict_form_submit&nonce="+s.nonce+"&entry_id="+c,success:function(n){n.success?(i.html('<div class="success-message">'+n.data.message+"</div>"),c||(t[0].reset(),e("#example-sentences-container").empty(),e("#selected-synonyms").empty(),e(".image-preview-container").empty(),e(".media-filename").empty()),n.data.edit_url&&i.append('<div class="info-message">View in admin: <a href="'+n.data.edit_url+'" target="_blank">Edit Post</a></div>')):i.html('<div class="error-message">'+n.data.message+"</div>"),a.prop("disabled",!1).text(c?"Save as New Draft":"Add Entry (Draft)"),e("html, body").animate({scrollTop:i.offset().top-100},500)},error:function(){i.html('<div class="error-message">An error occurred. Please try again.</div>'),a.prop("disabled",!1).text(c?"Save as New Draft":"Add Entry (Draft)")}})})});
//# sourceMappingURL=sparxstar-3iatlas-dictionary-form.min.js.map