{"version":3,"file":"js/sparxstar-3iatlas-dictionary-form.min.js","mappings":"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","sources":["webpack://sparxstar-3iatlas-dictionary/./src/js/sparxstar-iatlas-dictionary-form.js","webpack://sparxstar-3iatlas-dictionary/webpack/bootstrap","webpack://sparxstar-3iatlas-dictionary/webpack/runtime/compat get default export","webpack://sparxstar-3iatlas-dictionary/webpack/runtime/define property getters","webpack://sparxstar-3iatlas-dictionary/webpack/runtime/hasOwnProperty shorthand"],"sourcesContent":["jQuery(document).ready(function ($) {\n    // Sentence counter for new rows\n    let sentenceCounter = $('#example-sentences-container .sentence-row').length;\n    let sparxstarDict = window.sparxstarDict || {};\n\n    // Add sentence button\n    $('#add-sentence-btn').on('click', function () {\n        const index = sentenceCounter++;\n        const template = `\n            <div class=\"sentence-row\" data-index=\"${index}\">\n                <div class=\"sentence-fields\">\n                    <div class=\"form-group\">\n                        <label for=\"sentence_${index}_text\">Sentence</label>\n                        <input type=\"text\" id=\"sentence_${index}_text\" name=\"sentences[${index}][aiwa_sentence]\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"sentence_${index}_trans\">Translation</label>\n                        <input type=\"text\" id=\"sentence_${index}_trans\" name=\"sentences[${index}][aiwa_s_translation]\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"sentence_${index}_trans_en\">Translation (English)</label>\n                        <input type=\"text\" id=\"sentence_${index}_trans_en\" name=\"sentences[${index}][aiwa_s_translation_english]\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"sentence_${index}_trans_fr\">Translation (French)</label>\n                        <input type=\"text\" id=\"sentence_${index}_trans_fr\" name=\"sentences[${index}][aiwa_s_translation_french]\">\n                    </div>\n                </div>\n                <button type=\"button\" class=\"btn-text remove-sentence-btn\" aria-label=\"Remove sentence\">Remove</button>\n            </div>\n        `;\n        $('#example-sentences-container').append(template);\n    });\n\n    // Remove sentence button\n    $(document).on('click', '.remove-sentence-btn', function () {\n        $(this).closest('.sentence-row').remove();\n    });\n\n    // Media uploader\n    let mediaUploader;\n\n    $(document).on('click', '.upload-media-btn', function (e) {\n        e.preventDefault();\n\n        const button = $(this);\n        const fieldId = button.data('field');\n        const mediaType = button.data('type');\n        const container = button.closest('.media-upload-container');\n\n        // If the uploader object has already been created, reopen the dialog\n        if (mediaUploader) {\n            mediaUploader.open();\n            return;\n        }\n\n        // Create the media uploader\n        mediaUploader = wp.media({\n            title: mediaType === 'image' ? 'Choose Image' : 'Choose Audio File',\n            button: {\n                text: 'Use this file',\n            },\n            library: {\n                type: mediaType === 'image' ? 'image' : 'audio',\n            },\n            multiple: false,\n        });\n\n        // When a file is selected\n        mediaUploader.on('select', function () {\n            const attachment = mediaUploader.state().get('selection').first().toJSON();\n\n            $('#' + fieldId).val(mediaType === 'image' ? attachment.id : attachment.url);\n\n            if (mediaType === 'image') {\n                container\n                    .find('.image-preview-container')\n                    .html('<img src=\"' + attachment.url + '\" alt=\"Preview\">');\n                container.find('.remove-media-btn').attr('aria-label', 'Remove image');\n            } else {\n                container.find('.media-filename').text(attachment.filename);\n                container.find('.remove-media-btn').attr('aria-label', 'Remove audio file');\n            }\n\n            container.find('.remove-media-btn').show();\n        });\n\n        // Open the uploader dialog\n        mediaUploader.open();\n    });\n\n    // Remove media button\n    $(document).on('click', '.remove-media-btn', function (e) {\n        e.preventDefault();\n        const container = $(this).closest('.media-upload-container');\n        container.find('input[type=\"hidden\"]').val('');\n        container.find('.media-filename').text('');\n        container.find('.image-preview-container').html('');\n        $(this).hide();\n    });\n\n    // Synonym search with debounce\n    let synonymSearchTimeout;\n    $('#aiwa_synonyms_search').on('keyup', function () {\n        clearTimeout(synonymSearchTimeout);\n        const searchTerm = $(this).val();\n\n        if (searchTerm.length < 2) {\n            $('#synonym-results').empty();\n            return;\n        }\n\n        synonymSearchTimeout = setTimeout(function () {\n            $.ajax({\n                url: sparxstarDict.ajaxurl,\n                type: 'POST',\n                data: {\n                    action: 'aiwa_dict_search_synonyms',\n                    nonce: sparxstarDict.nonce,\n                    search: searchTerm,\n                },\n                success: function (response) {\n                    if (response.success) {\n                        displaySynonymResults(response.data.results);\n                    }\n                },\n            });\n        }, 300);\n    });\n\n    // Display synonym search results\n    function displaySynonymResults(results) {\n        const container = $('#synonym-results');\n        container.empty();\n\n        if (results.length === 0) {\n            container.html('<div class=\"no-results\">No results found</div>');\n            return;\n        }\n\n        results.forEach(function (result) {\n            const resultItem = $('<div class=\"synonym-result-item\" role=\"option\">')\n                .text(result.title)\n                .data('id', result.id)\n                .on('click', function () {\n                    addSynonym(result.id, result.title);\n                })\n                .on('keydown', function (e) {\n                    if (e.key === 'Enter' || e.key === ' ') {\n                        e.preventDefault();\n                        addSynonym(result.id, result.title);\n                    }\n                })\n                .attr('tabindex', '0');\n            container.append(resultItem);\n        });\n    }\n\n    // Add synonym\n    function addSynonym(id, title) {\n        // Check if already added\n        if ($('#selected-synonyms').find('[data-id=\"' + id + '\"]').length > 0) {\n            return;\n        }\n\n        const tag = $('<span class=\"synonym-tag\" role=\"listitem\">')\n            .attr('data-id', id)\n            .html(\n                title +\n                    ' <button type=\"button\" class=\"remove-synonym\" aria-label=\"Remove synonym ' +\n                    title +\n                    '\">Ã—</button>'\n            );\n\n        $('#selected-synonyms').append(tag);\n        updateSynonymField();\n        $('#synonym-results').empty();\n        $('#aiwa_synonyms_search').val('');\n    }\n\n    // Remove synonym\n    $(document).on('click', '.remove-synonym', function (e) {\n        e.preventDefault();\n        $(this).closest('.synonym-tag').remove();\n        updateSynonymField();\n    });\n\n    // Update hidden synonym field\n    function updateSynonymField() {\n        const ids = [];\n        $('#selected-synonyms .synonym-tag').each(function () {\n            ids.push($(this).data('id'));\n        });\n        $('#aiwa_synonyms').val(ids.join(','));\n    }\n\n    // Form submission\n    $('#sparx-dict-form').on('submit', function (e) {\n        e.preventDefault();\n\n        const form = $(this);\n        const submitBtn = $('#submit-btn');\n        const messageDiv = $('#form-message');\n\n        // Disable submit button\n        submitBtn.prop('disabled', true).text('Saving...');\n        messageDiv.empty();\n\n        // Serialize form data\n        const formData = form.serialize();\n        const entryId = form.data('entry-id');\n\n        $.ajax({\n            url: sparxstarDict.ajaxurl,\n            type: 'POST',\n            data:\n                formData +\n                '&action=aiwa_dict_form_submit&nonce=' +\n                sparxstarDict.nonce +\n                '&entry_id=' +\n                entryId,\n            success: function (response) {\n                if (response.success) {\n                    messageDiv.html(\n                        '<div class=\"success-message\">' + response.data.message + '</div>'\n                    );\n\n                    // Reset form if it was an add (not edit)\n                    if (!entryId) {\n                        form[0].reset();\n                        $('#example-sentences-container').empty();\n                        $('#selected-synonyms').empty();\n                        $('.image-preview-container').empty();\n                        $('.media-filename').empty();\n                    }\n\n                    // Show edit link\n                    if (response.data.edit_url) {\n                        messageDiv.append(\n                            '<div class=\"info-message\">View in admin: <a href=\"' +\n                                response.data.edit_url +\n                                '\" target=\"_blank\">Edit Post</a></div>'\n                        );\n                    }\n                } else {\n                    messageDiv.html(\n                        '<div class=\"error-message\">' + response.data.message + '</div>'\n                    );\n                }\n\n                // Re-enable submit button\n                submitBtn\n                    .prop('disabled', false)\n                    .text(entryId ? 'Save as New Draft' : 'Add Entry (Draft)');\n\n                // Scroll to message\n                $('html, body').animate(\n                    {\n                        scrollTop: messageDiv.offset().top - 100,\n                    },\n                    500\n                );\n            },\n            error: function () {\n                messageDiv.html(\n                    '<div class=\"error-message\">An error occurred. Please try again.</div>'\n                );\n                submitBtn\n                    .prop('disabled', false)\n                    .text(entryId ? 'Save as New Draft' : 'Add Entry (Draft)');\n            },\n        });\n    });\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))"],"names":["jQuery","document","ready","$","mediaUploader","synonymSearchTimeout","sentenceCounter","length","sparxstarDict","window","addSynonym","id","title","find","tag","attr","html","append","updateSynonymField","empty","val","ids","each","push","this","data","join","on","index","template","concat","closest","remove","e","preventDefault","button","fieldId","mediaType","container","wp","media","text","library","type","multiple","attachment","state","get","first","toJSON","url","filename","show","open","hide","clearTimeout","searchTerm","setTimeout","ajax","ajaxurl","action","nonce","search","success","response","results","forEach","result","resultItem","key","displaySynonymResults","form","submitBtn","messageDiv","prop","formData","serialize","entryId","message","reset","edit_url","animate","scrollTop","offset","top","error","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","n","getter","__esModule","d","a","definition","o","Object","defineProperty","enumerable","obj","prototype","hasOwnProperty","call"],"ignoreList":[],"sourceRoot":""}